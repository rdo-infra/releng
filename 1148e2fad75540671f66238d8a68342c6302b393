{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "7336a2b4_c40adc14",
        "filename": "scripts/upgrade_spec.sh",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 128
      },
      "writtenOn": "2023-06-14T15:10:08Z",
      "side": 1,
      "message": "we should only implemente the with_doc conditional for packages where that macro exist. So, we can have three cases:\n\n- Packages with no docs building at all:รง\n\n%pyproject_buildrequires -t -e %{default_toxenv}\n\n- Packages with docs building and without with_doc conditional:\n\n%pyproject_buildrequires -t -e %{default_toxenv},docs\n\n- Packages with docs building and with with_doc conditional:\n\n%if 0%{?with_doc}\n%pyproject_buildrequires -t -e %{default_toxenv},docs\n%else\n%pyproject_buildrequires -t -e %{default_toxenv}\n%endif",
      "range": {
        "startLine": 122,
        "startChar": 55,
        "endLine": 122,
        "endChar": 64
      },
      "revId": "1148e2fad75540671f66238d8a68342c6302b393",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "789bf12c_dca6d73f",
        "filename": "scripts/upgrade_spec.sh",
        "patchSetId": 3
      },
      "lineNbr": 122,
      "author": {
        "id": 757
      },
      "writtenOn": "2023-06-21T08:04:52Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "7336a2b4_c40adc14",
      "range": {
        "startLine": 122,
        "startChar": 55,
        "endLine": 122,
        "endChar": 64
      },
      "revId": "1148e2fad75540671f66238d8a68342c6302b393",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a3cdfb9c_6abf38fb",
        "filename": "scripts/upgrade_spec.sh",
        "patchSetId": 3
      },
      "lineNbr": 136,
      "author": {
        "id": 128
      },
      "writtenOn": "2023-06-14T15:10:08Z",
      "side": 1,
      "message": "Note that we use %{service} only in openstack services, for libraries or clients we use other macros as sname or pypi_name (or in some weird cases even a different one). see:\n\nhttps://review.rdoproject.org/r/c/openstack/oslo-config-distgit/+/46674/2/python-oslo-config.spec\n\nActually, that\u0027s one of the reasons i\u0027m still not sure if we should use pyproject_save_files or not...",
      "range": {
        "startLine": 136,
        "startChar": 71,
        "endLine": 136,
        "endChar": 81
      },
      "revId": "1148e2fad75540671f66238d8a68342c6302b393",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "43104846_3fb232b2",
        "filename": "scripts/upgrade_spec.sh",
        "patchSetId": 3
      },
      "lineNbr": 136,
      "author": {
        "id": 757
      },
      "writtenOn": "2023-06-21T08:04:52Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "a3cdfb9c_6abf38fb",
      "range": {
        "startLine": 136,
        "startChar": 71,
        "endLine": 136,
        "endChar": 81
      },
      "revId": "1148e2fad75540671f66238d8a68342c6302b393",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "596bc35a_8a4e07a9",
        "filename": "scripts/upgrade_spec.sh",
        "patchSetId": 3
      },
      "lineNbr": 141,
      "author": {
        "id": 128
      },
      "writtenOn": "2023-06-14T15:10:08Z",
      "side": 1,
      "message": "One problem we found in the poc was related to %pyproject_buildrequires does not handle pip constraint file (see https://review.rdoproject.org/etherpad/p/pyproject-macros#L54). The proposed solutionwas to add following line to the %prep phase:\n\nsed -i \u0027/.*-c{env:TOX_CONSTRAINTS_FILE.*/d\u0027 tox.ini\n\nI\u0027d say that should fix most of the cases.\n\nCould we add this line in this function?",
      "range": {
        "startLine": 141,
        "startChar": 9,
        "endLine": 141,
        "endChar": 25
      },
      "revId": "1148e2fad75540671f66238d8a68342c6302b393",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ddaac027_ec10cbe7",
        "filename": "scripts/upgrade_spec.sh",
        "patchSetId": 3
      },
      "lineNbr": 141,
      "author": {
        "id": 128
      },
      "writtenOn": "2023-06-14T16:27:53Z",
      "side": 1,
      "message": "There are some BRs that we always want to get rid of as in \nhttps://review.rdoproject.org/r/c/openstack/oslo-config-distgit/+/46674/2/python-oslo-config.spec#95\n\nsed -i \u0027/^doc8.*/d\u0027 doc/requirements.txt\nsed -i \u0027/^pre-commit.*/d\u0027 test-requirements.txt\nsed -i \u0027/^bandit.*/d\u0027 test-requirements.txt\nsed -i \u0027/^hacking.*/d\u0027 test-requirements.txt\n\n(and probably more will appear)\n\nWhat if we always add those lines in %prep ?",
      "parentUuid": "596bc35a_8a4e07a9",
      "range": {
        "startLine": 141,
        "startChar": 9,
        "endLine": 141,
        "endChar": 25
      },
      "revId": "1148e2fad75540671f66238d8a68342c6302b393",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b0b4cf20_2d03132a",
        "filename": "scripts/upgrade_spec.sh",
        "patchSetId": 3
      },
      "lineNbr": 141,
      "author": {
        "id": 757
      },
      "writtenOn": "2023-06-20T13:26:04Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ddaac027_ec10cbe7",
      "range": {
        "startLine": 141,
        "startChar": 9,
        "endLine": 141,
        "endChar": 25
      },
      "revId": "1148e2fad75540671f66238d8a68342c6302b393",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a149d7b1_52ab58fa",
        "filename": "scripts/upgrade_spec.sh",
        "patchSetId": 3
      },
      "lineNbr": 155,
      "author": {
        "id": 128
      },
      "writtenOn": "2023-06-14T15:10:08Z",
      "side": 1,
      "message": "A couple more things that could be implemented:\n\n- replacing sphinx-build command by \"%tox -edocs\" as in:\nhttps://review.rdoproject.org/r/c/openstack/oslo-config-distgit/+/46674/2/python-oslo-config.spec#117\n\n- replacing stestr in %check by %tox -e %{default_toxenv} (i\u0027d ignore options at least in initial versions)\n\nhttps://review.rdoproject.org/r/c/openstack/oslo-config-distgit/+/46674/2/python-oslo-config.spec#135",
      "revId": "1148e2fad75540671f66238d8a68342c6302b393",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e738b401_ae6a9bed",
        "filename": "scripts/upgrade_spec.sh",
        "patchSetId": 3
      },
      "lineNbr": 155,
      "author": {
        "id": 128
      },
      "writtenOn": "2023-06-14T16:27:53Z",
      "side": 1,
      "message": "one more, we should be able to remove any line containing python_provide, that\u0027s also deprecated.\n\nhttps://docs.fedoraproject.org/en-US/packaging-guidelines/Python/#_deprecated_macros",
      "parentUuid": "a149d7b1_52ab58fa",
      "revId": "1148e2fad75540671f66238d8a68342c6302b393",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "928db65b_09f20faa",
        "filename": "scripts/upgrade_spec.sh",
        "patchSetId": 3
      },
      "lineNbr": 155,
      "author": {
        "id": 757
      },
      "writtenOn": "2023-06-21T08:04:52Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e738b401_ae6a9bed",
      "revId": "1148e2fad75540671f66238d8a68342c6302b393",
      "serverId": "270e2033-b340-4cff-9539-693957ebf0e7"
    }
  ]
}